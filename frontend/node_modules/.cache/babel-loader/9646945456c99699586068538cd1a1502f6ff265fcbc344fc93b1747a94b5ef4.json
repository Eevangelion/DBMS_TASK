{"ast":null,"code":"var _jsxFileName = \"/home/ivan/working/DBMS_TASK/frontend/src/context/context.js\",\n  _s = $RefreshSig$();\nimport React, { createContext } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useAppDispatch, useAppSelector } from '../hooks/redux';\nimport { getAccessToken, getJWToken, getUserInfo } from '../store/actions/authActions';\nimport { logout } from '../store/reducers/AuthSlice';\nimport { clean } from '../store/reducers/UserSlice';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext(null);\nexport function AuthProvider(_ref) {\n  _s();\n  let {\n    children\n  } = _ref;\n  const dispatch = useAppDispatch();\n  const navigate = useNavigate();\n  const user = useAppSelector(state => state.VkAuth.user);\n  const token = localStorage.getItem('userToken');\n  const signin = () => {\n    return dispatch(getAccessToken()).then(() => dispatch(getJWToken()).then(() => dispatch(getUserInfo())));\n  };\n  if (token && !user) {\n    dispatch(getUserInfo()).catch(() => signin());\n  }\n  ;\n  const signout = () => {\n    dispatch(clean());\n    navigate('../');\n    window.scrollTo(0, 0);\n    return dispatch(logout());\n  };\n  const value = {\n    user,\n    signin,\n    signout\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 40,\n    columnNumber: 12\n  }, this);\n}\n_s(AuthProvider, \"vUHGDf6UZAHIs/JjurT7EUjDPcU=\", false, function () {\n  return [useAppDispatch, useNavigate, useAppSelector];\n});\n_c = AuthProvider;\n;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useNavigate","useAppDispatch","useAppSelector","getAccessToken","getJWToken","getUserInfo","logout","clean","AuthContext","AuthProvider","children","dispatch","navigate","user","state","VkAuth","token","localStorage","getItem","signin","then","catch","signout","window","scrollTo","value"],"sources":["/home/ivan/working/DBMS_TASK/frontend/src/context/context.js"],"sourcesContent":["import React, { createContext } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useAppDispatch, useAppSelector } from '../hooks/redux';\nimport { getAccessToken, getJWToken, getUserInfo } from '../store/actions/authActions';\nimport { logout } from '../store/reducers/AuthSlice';\nimport { clean } from '../store/reducers/UserSlice';\n\nexport const AuthContext = createContext(null);\n\nexport function AuthProvider({ children }) {\n\n    const dispatch = useAppDispatch(); \n    const navigate = useNavigate();\n    const user = useAppSelector(state => state.VkAuth.user);\n    const token = localStorage.getItem('userToken');    \n\n    const signin = () => { \n        return dispatch(getAccessToken())\n            .then(() => \n                dispatch(getJWToken())\n                    .then(() => \n                        dispatch(getUserInfo())\n                    )\n            );                 \n    };\n\n    if (token && !user) {\n        dispatch(getUserInfo()).catch(() => signin());\n    };\n\n    const signout = () => {\n        dispatch(clean());\n        navigate('../');\n        window.scrollTo(0,0);\n        return dispatch(logout());\n    };\n\n    const value = { user, signin, signout };\n\n    return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\n};"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,aAAa,QAAQ,OAAO;AAC5C,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,cAAc,EAAEC,cAAc,QAAQ,gBAAgB;AAC/D,SAASC,cAAc,EAAEC,UAAU,EAAEC,WAAW,QAAQ,8BAA8B;AACtF,SAASC,MAAM,QAAQ,6BAA6B;AACpD,SAASC,KAAK,QAAQ,6BAA6B;AAAC;AAEpD,OAAO,MAAMC,WAAW,gBAAGT,aAAa,CAAC,IAAI,CAAC;AAE9C,OAAO,SAASU,YAAY,OAAe;EAAA;EAAA,IAAd;IAAEC;EAAS,CAAC;EAErC,MAAMC,QAAQ,GAAGV,cAAc,EAAE;EACjC,MAAMW,QAAQ,GAAGZ,WAAW,EAAE;EAC9B,MAAMa,IAAI,GAAGX,cAAc,CAACY,KAAK,IAAIA,KAAK,CAACC,MAAM,CAACF,IAAI,CAAC;EACvD,MAAMG,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC;EAE/C,MAAMC,MAAM,GAAG,MAAM;IACjB,OAAOR,QAAQ,CAACR,cAAc,EAAE,CAAC,CAC5BiB,IAAI,CAAC,MACFT,QAAQ,CAACP,UAAU,EAAE,CAAC,CACjBgB,IAAI,CAAC,MACFT,QAAQ,CAACN,WAAW,EAAE,CAAC,CAC1B,CACR;EACT,CAAC;EAED,IAAIW,KAAK,IAAI,CAACH,IAAI,EAAE;IAChBF,QAAQ,CAACN,WAAW,EAAE,CAAC,CAACgB,KAAK,CAAC,MAAMF,MAAM,EAAE,CAAC;EACjD;EAAC;EAED,MAAMG,OAAO,GAAG,MAAM;IAClBX,QAAQ,CAACJ,KAAK,EAAE,CAAC;IACjBK,QAAQ,CAAC,KAAK,CAAC;IACfW,MAAM,CAACC,QAAQ,CAAC,CAAC,EAAC,CAAC,CAAC;IACpB,OAAOb,QAAQ,CAACL,MAAM,EAAE,CAAC;EAC7B,CAAC;EAED,MAAMmB,KAAK,GAAG;IAAEZ,IAAI;IAAEM,MAAM;IAAEG;EAAQ,CAAC;EAEvC,oBAAO,QAAC,WAAW,CAAC,QAAQ;IAAC,KAAK,EAAEG,KAAM;IAAA,UAAEf;EAAQ;IAAA;IAAA;IAAA;EAAA,QAAwB;AAChF;AAAC,GA/BeD,YAAY;EAAA,QAEPR,cAAc,EACdD,WAAW,EACfE,cAAc;AAAA;AAAA,KAJfO,YAAY;AA+B3B;AAAC;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}